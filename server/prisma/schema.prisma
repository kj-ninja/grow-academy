// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["omitApi"]
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id              Int                @id @default(autoincrement())
  username        String             @unique
  password        String
  role            String             @default("user")
  createdAt       DateTime           @default(now())
  updatedAt       DateTime           @updatedAt
  firstName       String?
  lastName        String?
  bio             String?
  avatarImage     Bytes?
  isActive        Boolean            @default(false)
  classrooms      ClassroomsMembers[]
  ownedClassrooms Classroom[]
}

// todo:
// ClassroomsApplicants table for private classrooms
// user id, class room id, status
// remove status from ClassroomsMembers and add relation to classroom
// add ot to the User and Classroom

model ClassroomsMembers {
  classroom        Classroom @relation(fields: [classroomId], references: [id])
  classroomId      Int
  user             User      @relation(fields: [userId], references: [id])
  userId           Int
  role             String    @default("member")
  memberShipStatus String    @default("pending")

  @@id([userId, classroomId])
}

model Classroom {
  id                       Int                @id @default(autoincrement())
  name                     String             @unique
  description              String?
  accessType               String             @default("public")
  createdAt                DateTime           @default(now())
  updatedAt                DateTime           @updatedAt
  owner                    User               @relation(fields: [ownerId], references: [id])
  ownerId                  Int
  members                  ClassroomsMembers[]
  communityAvatarImage     Bytes?
  communityBackgroundImage Bytes?
  getStreamChannel         String?
  isLive                   Boolean            @default(false)
}